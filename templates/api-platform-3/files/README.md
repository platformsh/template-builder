<p align="right">
<a href="https://platform.sh">
   <svg viewBox="0 0 200 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M200 0h-33.078v13.06H200V0zM200 28.422h-33.078v4.448H200v-4.448zM200 17.283h-33.078v6.701H200v-6.7zM0 16.222h4.183v2.49a6.21 6.21 0 012.201-2.073 6.06 6.06 0 013.082-.8 6.465 6.465 0 015.017 2.318 9.362 9.362 0 012.062 6.453 9.674 9.674 0 01-2.074 6.604 6.49 6.49 0 01-5.028 2.318c-.881.01-1.753-.18-2.55-.556a8.599 8.599 0 01-2.398-1.912v8.539H.012V16.199L0 16.222zm4.438 8.191a6.523 6.523 0 001.158 4.23 3.477 3.477 0 002.77 1.366 3.243 3.243 0 002.606-1.25 6.477 6.477 0 001.031-4.114 6.152 6.152 0 00-1.066-3.962 3.301 3.301 0 00-2.653-1.287A3.477 3.477 0 005.55 20.66a5.654 5.654 0 00-1.112 3.754zM18.619 33.23V9.78h4.484v23.45h-4.484zM29.544 21.4l-4.066-.73a6.35 6.35 0 012.317-3.637 8.655 8.655 0 014.982-1.159 10.775 10.775 0 014.472.707 4.461 4.461 0 012.074 1.807 9.27 9.27 0 01.603 4.02v5.238c-.027 1.105.046 2.21.22 3.302.17.804.443 1.582.81 2.317H36.52a14.315 14.315 0 01-.428-1.332c-.081-.267-.128-.44-.163-.522a8.11 8.11 0 01-2.456 1.68 7.103 7.103 0 01-2.792.556 5.794 5.794 0 01-4.125-1.425 4.716 4.716 0 01-1.506-3.591c-.017-.901.22-1.789.684-2.561a4.473 4.473 0 011.923-1.726 15.14 15.14 0 013.569-1.043 24.245 24.245 0 004.356-1.159v-.498a2.317 2.317 0 00-.637-1.842 3.835 3.835 0 00-2.41-.556 3.199 3.199 0 00-1.866.475 3.245 3.245 0 00-1.124 1.68zm6.002 3.639c-.58.185-1.483.417-2.734.683a8.343 8.343 0 00-2.445.777 1.876 1.876 0 00-.869 1.587 2.214 2.214 0 00.707 1.634 2.467 2.467 0 001.784.683 3.87 3.87 0 002.317-.8c.512-.36.887-.882 1.066-1.482.15-.72.208-1.456.174-2.19v-.892zM50.77 16.222v3.58H47.7v6.835c-.027.809.005 1.618.093 2.422.06.233.205.435.405.568.22.156.484.237.753.231a5.794 5.794 0 001.808-.44l.382 3.476a8.909 8.909 0 01-3.545.672 5.653 5.653 0 01-2.19-.406 3.174 3.174 0 01-1.425-1.054 4.193 4.193 0 01-.637-1.75 21.903 21.903 0 01-.14-3.162v-7.392h-2.062v-3.58h2.063V12.85l4.507-2.618v5.99h3.07-.012zM52.08 16.222h2.49v-1.275a8.53 8.53 0 01.453-3.198 3.592 3.592 0 011.68-1.714 6.43 6.43 0 013.093-.672c1.274 0 2.54.195 3.754.579l-.602 3.128a8.837 8.837 0 00-2.063-.255 1.84 1.84 0 00-1.402.452 2.618 2.618 0 00-.428 1.75v1.158h3.348v3.476h-3.348v13.58H54.57V19.754H52.08v-3.533zM63.249 24.472a9.177 9.177 0 011.158-4.322 7.589 7.589 0 013.117-3.198 9.268 9.268 0 014.507-1.158 8.457 8.457 0 016.303 2.502 8.63 8.63 0 012.468 6.315 8.736 8.736 0 01-2.48 6.384 8.412 8.412 0 01-6.256 2.537 9.814 9.814 0 01-4.45-1.054 7.219 7.219 0 01-3.22-3.094 10.301 10.301 0 01-1.147-4.912zm4.634.243a5.608 5.608 0 001.159 3.87 3.905 3.905 0 005.897 0 5.688 5.688 0 001.159-3.893 5.573 5.573 0 00-1.159-3.835 3.915 3.915 0 00-5.897 0 5.608 5.608 0 00-1.205 3.846l.046.012zM86.908 33.23h-4.484V16.222h4.16v2.41a7.126 7.126 0 011.923-2.248 3.476 3.476 0 011.934-.545 5.689 5.689 0 012.955.846l-1.39 3.916a3.917 3.917 0 00-2.11-.741 2.491 2.491 0 00-1.598.521c-.53.504-.89 1.16-1.031 1.877a26.716 26.716 0 00-.37 5.689v5.283h.01zM94.74 16.223h4.136v2.317a6.66 6.66 0 015.284-2.7 5.693 5.693 0 012.827.672 5.13 5.13 0 011.958 2.028 7.745 7.745 0 012.41-2.028 5.894 5.894 0 012.757-.672 6.152 6.152 0 013.163.753 4.637 4.637 0 011.935 2.236 9.574 9.574 0 01.463 3.476v10.926h-4.472v-9.698a7.232 7.232 0 00-.463-3.255 2.134 2.134 0 00-1.912-.962 3.06 3.06 0 00-1.773.58 3.173 3.173 0 00-1.158 1.68 12.221 12.221 0 00-.36 3.475v8.11h-4.495v-9.269a12.902 12.902 0 00-.232-3.186 2.027 2.027 0 00-.741-1.077 2.319 2.319 0 00-1.367-.348 3.28 3.28 0 00-1.866.556c-.553.395-.96.96-1.158 1.61a12.013 12.013 0 00-.36 3.477v8.307h-4.483V16.222h-.093zM121.921 33.23v-4.483h4.484v4.483h-4.484zM128.085 28.34l4.507-.683c.133.782.545 1.49 1.159 1.993.721.49 1.585.726 2.456.672a4.434 4.434 0 002.618-.637 1.423 1.423 0 00.591-1.159 1.146 1.146 0 00-.324-.846 3.536 3.536 0 00-1.506-.59c-3.615-.773-5.909-1.503-6.883-2.19a4.374 4.374 0 01-2.016-3.812 4.723 4.723 0 011.738-3.708 8.113 8.113 0 015.4-1.53c1.801-.12 3.6.283 5.178 1.16a5.792 5.792 0 012.318 3.348l-4.229.788a2.61 2.61 0 00-1.031-1.518 3.767 3.767 0 00-2.167-.521 4.864 4.864 0 00-2.537.498 1.06 1.06 0 00-.51.915 1.006 1.006 0 00.452.811 16.863 16.863 0 004.194 1.263c1.794.29 3.503.97 5.005 1.993a4.162 4.162 0 011.402 3.337 5.115 5.115 0 01-1.946 4.009 8.6 8.6 0 01-5.794 1.68 9.45 9.45 0 01-5.491-1.414 6.463 6.463 0 01-2.584-3.858zM150.226 9.78v8.608a6.72 6.72 0 017.983-1.97 4.529 4.529 0 011.877 1.472c.417.595.709 1.27.857 1.981.183 1.114.261 2.243.232 3.372v9.987h-4.495v-8.968a13.572 13.572 0 00-.255-3.383 2.227 2.227 0 00-.904-1.158 2.93 2.93 0 00-1.622-.418 3.685 3.685 0 00-1.993.545 3.103 3.103 0 00-1.286 1.634 9.793 9.793 0 00-.406 3.232v8.516h-4.483V9.78H150.226z" fill="#171719"></path>
</svg>
</a>
</p>

<h1 align="center">Deploy API Platform api and API Platform admin (ReactJS) on Platform.sh</h1>

<p align="center">
<strong>Contribute, request a feature, or check out our resources</strong>
<br />
<br />
<a href="https://community.platform.sh"><strong>Join our community</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://docs.platform.sh"><strong>Documentation</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://platform.sh/blog"><strong>Blog</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://github.com/platformsh-templates/API-Platform-v3/issues/new?assignees=&labels=bug&template=bug_report.yml"><strong>Report a bug</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://github.com/platformsh-templates/API-Platform-v3/issues/new?assignees=&labels=feature+request&template=improvements.yml"><strong>Request a feature</strong></a>
<br /><br />
</p>

<p align="center">
<a href="https://github.com/platformsh-templates/API-Platform-v3/issues">
<img src="https://img.shields.io/github/issues/platformsh-templates/API-Platform-v3.svg?style=for-the-badge&labelColor=f4f2f3&color=ffd9d9&label=Issues" alt="Open issues" />
</a>&nbsp&nbsp
<a href="https://github.com/platformsh-templates/API-Platform-v3/pulls">
<img src="https://img.shields.io/github/issues-pr/platformsh-templates/API-Platform-v3.svg?style=for-the-badge&labelColor=f4f2f3&color=ffd9d9&label=Pull%20requests" alt="Open PRs" />
</a>&nbsp&nbsp
</p>
<p align="center">
<a href="https://console.platform.sh/projects/create-project?template=https://raw.githubusercontent.com/platformsh-templates/API-Platform-v3/main/.platform/metadata/api-platform-3-php8.1.template.yaml&utm_content=platformsh-templates&utm_source=github&utm_medium=button&utm_campaign=deploy_on_platform" target="_blank">
    <img src="https://platform.sh/images/deploy/deploy-button-lg-blue.svg" alt="Deploy on Platform.sh" width="175px">
</a>
</p>

<hr>

<p align="center">
<strong>Contents</strong>
<br /><br />
<a href="#about"><strong>About</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="#getting-started"><strong>Getting started</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="#migrate"><strong>Migrate</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="#learn"><strong>Learn</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="#contribute"><strong>Contribute</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<br />
</p>
<hr>

## About

<p>
   We have just created a new multi-app project for you, based on <a href="https://api-platform.com/docs/core/" target="_blank">API Platform component</a> and <a href="https://api-platform.com/docs/admin/" target="_blank">API Platform Admin</a>.
   <BR>The generated code has been optimized for a typical web application hosted on <a href="https://platform.sh/">Platform.sh</a>.
</p>

### Features
- PHP 8.1
- PostgreSQL v13
- Composer-based build
- Yarn v1.22.15
- NodeJS v16
- a sample Product and Offer Entities

## Getting started

[comment]: <> (### Deploy)

### Quickstart

<p>
<a href="https://console.platform.sh/projects/create-project?template=https://raw.githubusercontent.com/platformsh-templates/API-Platform-v3/main/.platform/metadata/api-platform-3-php8.1.template.yaml&utm_content=platformsh-template&utm_source=github&utm_medium=button&utm_campaign=deploy_on_platform" target="_blank">
    <img src="https://platform.sh/images/deploy/deploy-button-lg-blue.svg" alt="Deploy on Platform.sh" width="175px">
</a>
</p>

[Create a Platform.sh project](https://platform.sh/free-trial).

Clone the GitHub repository and push its content to your Platform.sh project:

```bash
git clone git@github.com:platformsh-templates/API-Platform-v3.git
cd API-Platform-v3/
git remote add platform [project-id]@git.[region].platform.sh:[project-id].git
git push platform main
```

[comment]: <> (SSH to the `api` remote application and create the database schema:)

[comment]: <> (```)

[comment]: <> (ssh [project-id]-master-[string-identifier]--api@ssh.[region].platform.sh)

[comment]: <> (php bin/console doctrine:schema:create)

[comment]: <> (```)

You can now access the `admin` URL provided by Platform.sh and enjoy.

The quickest way to deploy this template on Platform.sh is by clicking the button below.
This will automatically create a new project and initialize the repository for you.

[comment]: <> (TODO You can also quickly recreate this project locally with the following command:)

[comment]: <> (```bash)

[comment]: <> (composer create-project platformsh-templates/API-Platform-v3:main -s dev)

[comment]: <> (```)


> **Note:**
>
> Platform.sh templates prioritize upstream release versions over our own. Despite this, we update template dependencies on a scheduled basis independent of those upstreams. <br>Because of this, template repos do not contain releases. This may change in the future, but until then the `-s dev` flag is necessary to use `composer create-project`.

#### Other deployment options

For all the other options below, clone this repository first:

```bash
git clone https://github.com/platformsh-templates/API-Platform-v3.git
```

If you're trying to deploy from GitHub, you can generate a copy of this repository first in your own namespace by clicking the [Use this template](https://github.com/platformsh-templates/API-Platform-v3/generate) button at the top of this page.

Then you can clone a copy of it locally with `git clone git@github.com:YOUR_NAMESPACE/API-Platform-v3.git`.


<details>
<summary>Deploy directly to Platform.sh from the command line</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to this repository's settings, or to what you have updated the default branch to locally.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Set the project remote

   Find your `PROJECT_ID` by running the command `platform project:list`

   ```bash
   +---------------+------------------------------------+------------------+---------------------------------+
   | ID            | Title                              | Region           | Organization                    |
   +---------------+------------------------------------+------------------+---------------------------------+
   | PROJECT_ID    | Your Project Name                  | xx-5.platform.sh | your-username                   |
   +---------------+------------------------------------+------------------+---------------------------------+
   ```

   Then from within your local copy, run the command `platform project:set-remote PROJECT_ID`.

1. Push

   ```bash
   git push platform DEFAULT_BRANCH
   ```

<!-- <br/>
</blockquote> -->
</details>

<details>
<summary>Integrate with a GitHub repo and deploy pull requests</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to whatever you have set at `https://YOUR_NAMESPACE/nextjs-drupal`.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Setup the integration:

   Consult the [GitHub integration documentation](https://docs.platform.sh/integrations/source/github.html#setup) to finish connecting your repository to a project on Platform.sh. You will need to create an Access token on GitHub to do so.

<!-- <br/>
</blockquote> -->
</details>

<details>
<summary>Integrate with a GitLab repo and deploy merge requests</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to this repository's settings, or to what you have updated the default branch to locally.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Create the repository

   Create a new repository on GitLab, set it as a new remote for your local copy, and push to the default branch.

1. Setup the integration:

   Consult the [GitLab integration documentation](https://docs.platform.sh/integrations/source/gitlab.html#setup) to finish connecting a repository to a project on Platform.sh. You will need to create an Access token on GitLab to do so.

<!-- <br/>
</blockquote> -->
</details>

<details>
<summary>Integrate with a Bitbucket repo and deploy pull requests</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to this repository's settings, or to what you have updated the default branch to locally.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Create the repository

   Create a new repository on Bitbucket, set it as a new remote for your local copy, and push to the default branch.

1. Setup the integration:

   Consult the [Bitbucket integration documentation](https://docs.platform.sh/integrations/source/bitbucket.html#setup) to finish connecting a repository to a project on Platform.sh. You will need to create an Access token on Bitbucket to do so.

<!-- <br/>
</blockquote> -->
</details>

[comment]: <> (### Post-install)

[comment]: <> (Run through the Symfony installer as normal.  You will not be asked for database credentials as those are already provided.)





### Local development

This section provides instructions for running the `API Platform` template locally, connected to a local database instance.

In all cases for developing with Platform.sh, it's important to develop on an isolated environment - do not connect to data on your production environment when developing locally.

Each of the options below assume that you have already deployed this template to Platform.sh, as well as the following starting commands:

```bash

$ platform get PROJECT_ID

$ cd project-name

$ platform environment:branch new_branch

```

<details>

<summary>API Platform: using Symfony Server</summary>
In general, the steps are as follows:

1. if you didn't get your Platform project yet, `git clone git@github.com:platformsh-templates/api-platform-api-admin.git api-platform`
   (or your own repo if you already created a fork)

2. `cd ./api-platform`

3. Start the API component with those steps:

   1. `cd ./api`

   1. Install the <a href="https://symfony.com/download" target="_blank">Symfony CLI</a>

   1. start docker container for the database : `docker-compose up -d`

   1. `symfony composer install`

   1. check that your api/.env file contains a valid `DATABASE_URL` to let Symfony connect to your database

   1. `symfony console doctrine:schema:create --dump-sql` (change to option `--force` to run those sql requests)

   1. `symfony server:start -d`

   1. et voilà, you can go on `<generatedUrlFromSymfonyServerStartCommand>/api` to display your swagger interface, showing entities Offer and Product CRUD option

> **Note:**
> if symfony server does not start your app using default port 8000, please change `REACT_APP_PUBLIC_URL` from `./admin/.env` file accordingly

3. Start the admin component with those steps

   1. `cd ../admin` (assuming that you're in the `./api` folder)

   1. `yarn install`

   1. `yarn start`

   1. et voilà, a new browser tab would open at url <a href="http://localhost:3000/" target="_blank">http://localhost:3000</a>

</details>

> **Note:**
> For many of the steps above, you may need to include the CLI flags `-p PROJECT_ID` and `-e ENVIRONMENT_ID` if you are not in the project directory or if the environment is associated with an existing pull request.
### Deploying to Platform.sh

This repository has all of the code it needs in order to deploy to Platform.sh.


<details>
<summary>Deploy directly to Platform.sh from the command line</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to this repository's settings, or to what you have updated the default branch to locally.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Set the project remote

   Find your `PROJECT_ID` by running the command `platform project:list`

   ```bash
   +---------------+------------------------------------+------------------+---------------------------------+
   | ID            | Title                              | Region           | Organization                    |
   +---------------+------------------------------------+------------------+---------------------------------+
   | PROJECT_ID    | Your Project Name                  | xx-5.platform.sh | your-username                   |
   +---------------+------------------------------------+------------------+---------------------------------+
   ```

   Then from within your local copy, run the command `platform project:set-remote PROJECT_ID`.

1. Push using git

   ```bash
   git push platform DEFAULT_BRANCH
   ```

1. or Push using platform

   ```bash
   platform push
   ```

<!-- <br/>
</blockquote> -->
</details>

<details>
<summary>Integrate with a GitHub repo and deploy pull requests</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to whatever you have set at `https://YOUR_NAMESPACE/nextjs-drupal`.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Setup the integration:

   Consult the [GitHub integration documentation](https://docs.platform.sh/integrations/source/github.html#setup) to finish connecting your repository to a project on Platform.sh. You will need to create an Access token on GitHub to do so.

<!-- <br/>
</blockquote> -->
</details>

<details>
<summary>Integrate with a GitLab repo and deploy merge requests</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to this repository's settings, or to what you have updated the default branch to locally.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Create the repository

   Create a new repository on GitLab, set it as a new remote for your local copy, and push to the default branch.

1. Setup the integration:

   Consult the [GitLab integration documentation](https://docs.platform.sh/integrations/source/gitlab.html#setup) to finish connecting a repository to a project on Platform.sh. You will need to create an Access token on GitLab to do so.

<!-- <br/>
</blockquote> -->
</details>

<details>
<summary>Integrate with a Bitbucket repo and deploy pull requests</summary>
<!-- <blockquote>
<br/> -->

1. Create a free trial:

   [Register for a 30 day free trial with Platform.sh](https://auth.api.platform.sh/register). When you have completed signup, select the **Create from scratch** project option. Give you project a name, and select a region where you would like it to be deployed. As for the *Production environment* option, make sure to match it to this repository's settings, or to what you have updated the default branch to locally.

1. Install the Platform.sh CLI

   #### Linux/OSX

   ```bash
   curl -sS https://platform.sh/cli/installer | php
   ```

   #### Windows

   ```bash
   curl -f https://platform.sh/cli/installer -o cli-installer.php
   php cli-installer.php
   ```

   You can verify the installation by logging in (`platformsh login`) and listing your projects (`platform project:list`).

1. Create the repository

   Create a new repository on Bitbucket, set it as a new remote for your local copy, and push to the default branch.

1. Setup the integration:

   Consult the [Bitbucket integration documentation](https://docs.platform.sh/integrations/source/bitbucket.html#setup) to finish connecting a repository to a project on Platform.sh. You will need to create an Access token on Bitbucket to do so.

<!-- <br/>
</blockquote> -->
</details>

### Migrating your data

If you are moving an existing site to Platform.sh, then in addition to code you also need to migrate your data. That means your database and your files.

<details>
<summary>Importing the database</summary><br/>

First, obtain a database dump from your current site and save your dump file as `database.sql`. Then, import the database into your Platform.sh site using the CLI:

```bash
platform sql -e main < database.sql
```

</details>
<details>
<summary>Importing files</summary><br/>

You first need to download your files from your current hosting environment.
The easiest way is likely with rsync, but consult your old host's documentation.

The `platform mount:upload` command provides a straightforward way to upload an entire directory to your site at once to a `mount` defined in a `.platform.app.yaml` file.
Under the hood, it uses an SSH tunnel and rsync, so it is as efficient as possible.
(There is also a `platform mount:download` command you can use to download files later.)
Run the following from your local Git repository root (modifying the `--source` path if needed and setting `BRANCH_NAME` to the branch you are using).

A few examples are listed below, but repeat for all directories that contain data you would like to migrate.

```bash
$ platform mount:upload -e main --mount web/sites/default/files --source ./web/sites/default/files
$ platform mount:upload -e main --mount private --source ./private
```

Note that `rsync` is picky about its trailing slashes, so be sure to include those.

</details>

With your application now deployed on Platform.sh, things get more interesting.
Run the command `platform environment:branch new-feature` for your project, or open a trivial pull request off of your current branch.

The resulting environment is an *exact* copy of production.
It contains identical infrastructure to what's been defined in your configuration files, and even includes data copied from your production environment in its services.
On this isolated environment, you're free to make any changes to your application you need to, and really test how they will behave on production.

After that, here are a collection of additional resources you might find interesting as you continue with your migration to Platform.sh:

[comment]: <> (- [Local development]&#40;#local-development&#41;)
- [Troubleshooting](#troubleshooting)
- [Adding a domain and going live](https://docs.platform.sh/domains/steps.html)
- [(CDN) Content Delivery Networks](https://docs.platform.sh/domains/cdn.html)
- [Performance and observability with Blackfire.io](https://docs.platform.sh/integrations/observability/blackfire.html)
- [Pricing](https://docs.platform.sh/overview/pricing.html)
- [Security and compliance](https://docs.platform.sh/security.html)


## Learn

### Troubleshooting


<details>
<summary><strong>Accessing logs</strong></summary><br/>

After the environment has finished its deployment, you can investigate issues that occured on startup, `deploy` and `post_deploy` hooks, and generally at runtime using the CLI. Run the command:

```bash
platform ssh
```

If you are running the command outside of a local copy of the project, you will need to include the `-p` (project) and/or `-e` (environment) flags as well.
Once you have connected to the container, [logs](https://docs.platform.sh/development/logs.html#container-logs) are available within `/var/log/` for you to investigate.

</details>


<details>
<summary><strong>Rebuilding cache</strong></summary><br/>

You may run into a database error after installing Symfony on your production environment initially.
To fix, SSH into the application container (`platform ssh`) and rebuild the cache using Symfony console:

```bash
php bin/console cache:clear
php bin/console cache:pool:clear cache.redis
```
</details>

### Blackfire.io: creating a Continuous Observability Strategy

This template includes a starting [`.blackfire.yml`](.blackfire.yml) file that can be used to enable [Application Performance Monitoring](https://blackfire.io/docs/monitoring-cookbooks/index), [Profiling](https://blackfire.io/docs/profiling-cookbooks/index), [Builds](https://blackfire.io/docs/builds-cookbooks/index) and [Performance Testing](https://blackfire.io/docs/testing-cookbooks/index) on your project. Platform.sh comes with Blackfire pre-installed on application containers, and [setting up requires minimal configuration](https://docs.platform.sh/integrations/observability/blackfire.html).

* [What is Blackfire?](https://blackfire.io/docs/introduction)
* [Configuring Blackfire.io on a Platform.sh project](https://docs.platform.sh/integrations/observability/blackfire.html)
* [Blackfire.io Platform.sh documentation](https://blackfire.io/docs/integrations/paas/platformsh)
* [Profiling Cookbooks](https://blackfire.io/docs/profiling-cookbooks/index)
* [Monitoring Cookbooks](https://blackfire.io/docs/monitoring-cookbooks/index)
* [Testing Cookbooks](https://blackfire.io/docs/testing-cookbooks/index)
* [Using Builds](https://blackfire.io/docs/builds-cookbooks/index)
* [Configuring Integrations](https://blackfire.io/docs/integrations/index)


### Resources


- [API Platform](https://api-platform.com/)

- [Platform.sh PHP documentation](https://docs.platform.sh/languages/php.html)


### Contact

This template is maintained by the Platform.sh Developer Relations team, and they will be notified of all issues and pull requests you open here.

- **Community:** Share your question with the community, or see if it's already been asked on our [Community site](https://community.platform.sh).
- **Slack:** If you haven't done so already, you can join Platform.sh's [public Slack](https://chat.platform.sh/) channels and ping the `@devrel_team` with any questions.


### About Platform.sh

This template has been specifically designed to deploy on Platform.sh.

<details>
<summary>What is Platform.sh?</summary><br/>

Platform.sh is a unified, secure, enterprise-grade platform for building, running and scaling web applications. We’re the leader in Fleet Ops: Everything you need to manage your fleet of websites and apps is available from the start. Because infrastructure and workflows are handled from the start, apps just work, so teams can focus on what really matters: making faster changes, collaborating confidently, and scaling responsibly. Whether managing a fleet of ten or ten thousand sites and apps, Platform.sh is the Developer- preferred solution that scales right.

Our key features include:

* **GitOps: Git as the source of truth**

  Every branch becomes a development environment, and nothing can change without a commit.

* **Batteries included: Managed infrastructure**

  [Simple abstraction in YAML](https://docs.platform.sh/configuration/yaml.html) for [committing and configuring infrastructure](https://docs.platform.sh/overview/structure.html), fully managed patch updates, and 24 [runtimes](https://docs.platform.sh/languages.html) & [services](https://docs.platform.sh/configuration/services.html) that can be added with a single line of code.

* **Instant cloning: Branch, merge, repeat**

  [Reusable builds](https://docs.platform.sh/overview/build-deploy.html) and automatically inherited production data provide true staging environments - experiment in isolation, test, then destroy or merge.

* **FleetOps: Fleet management platform**

  Leverage our public API along with custom tools like [Source Operations](https://docs.platform.sh/configuration/app/source-operations.html) and [Activity Scripts](https://docs.platform.sh/integrations/activity.html) to [manage thousands of applications](https://youtu.be/MILHG9OqhmE) - their dependency updates, fresh content, and upstream code.


To find out more, check out the demo below and go to our [website](https://platform.sh/product/).

<br/>
<p align="center">
<a href="https://platform.sh/demo/"><img src="https://img.youtube.com/vi/ny2YeD6Qt3M/0.jpg" alt="The Platform.sh demo"></a>
</p>

</details>

## Contribute

<h3 align="center">Help us keep top-notch templates!</h3>

Every one of our templates is open source, and they're important resources for users trying to deploy to Platform.sh for the first time or better understand the platform. They act as getting started guides, but also contain a number of helpful tips and best practices when working with certain languages and frameworks.

See something that's wrong with this template that needs to be fixed? Something in the documentation unclear or missing? Let us know!

<p align="center">
<strong>How to contribute</strong>
<br /><br />
<a href="https://github.com/platformsh-templates/API-Platform-v3/issues/new?assignees=&labels=bug&template=bug_report.yml"><strong>Report a bug</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://github.com/platformsh-templates/API-Platform-v3/issues/new?assignees=&labels=feature+request&template=improvements.yml"><strong>Submit a feature request</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://github.com/platformsh-templates/API-Platform-v3/pulls"><strong>Open a pull request</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<br />
</p>
<br />
<p align="center">
<strong>Need help?</strong>
<br /><br />
<a href="https://community.platform.sh"><strong>Ask the Platform.sh Community</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<a href="https://chat.platform.sh"><strong>Join us on Slack</strong></a>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<br />
</p>
<br />
<h3 align="center"><strong>Thanks to all of our amazing contributors!</strong></h3>
<br/>
<p align="center">
<a href="https://github.com/platformsh-templates/API-Platform-v3/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=platformsh-templates/API-Platform-v3" />
</a>
</p>

<p align="center">
<em>Made with <a href="https://contrib.rocks">contrib.rocks</a></em>
</p>

<br />
